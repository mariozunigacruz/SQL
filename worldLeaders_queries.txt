USE world_leaders;
-- length_of_power_in_US_in_party
CREATE OR REPLACE VIEW president_power_lenght_in_party_in_us AS
	SELECT CONCAT(f_name, ' ', l_name) AS president_name, length_of_power
    FROM ((world_presidents JOIN background USING (leader_ID)) 
		JOIN president_election USING (president_ID)) 
    WHERE president_ID IN (SELECT president_ID FROM president_election WHERE party IS NOT NULL)
    ORDER BY length_of_power DESC, president_name;



USE world_leaders;
-- number_of_president_age_higher_than_60_with_election_later_than_2000_in_different_country
CREATE OR REPLACE VIEW number_of_president_older_than_60_elected_after_2000 AS
	SELECT country, COUNT(age) AS number_of_president
    FROM (world_presidents 
		JOIN background USING (leader_ID))
        JOIN president_election USING (president_ID)
    WHERE date_of_election BETWEEN '2000-00-00' AND NOW() AND age > 60 
    GROUP BY country
    ORDER BY number_of_president DESC, country;



USE world_leaders;
-- offically_educated_president_average_power_length_in_different_country
CREATE OR REPLACE VIEW offically_educated_president_average_power_length AS
	SELECT country, ROUND(AVG(length_of_power), 1) AS average_length_of_power
    FROM world_presidents JOIN background USING (leader_ID)
    WHERE education != 'Self'
    GROUP BY country
    ORDER BY average_length_of_power DESC, country; 



USE world_leaders;
-- show the president with his/her pet
CREATE OR REPLACE VIEW president_pets AS
	SELECT CONCAT(f_name, ' ', l_name) AS president_name, pets
    FROM world_presidents JOIN fun_facts USING(person_id)
    WHERE pets IS NOT NULL
    ORDER BY president_name, pets;



USE world_leaders;
-- re-elected_president_record
CREATE OR REPLACE VIEW re_elected_president_record AS
	SELECT CONCAT(f_name, ' ', l_name) AS president_name, country, number_of_terms, term
    FROM ((world_presidents JOIN background USING (leader_ID)) 
		JOIN president_election USING (president_ID)) 
        JOIN presidental_term USING(term_id)
    WHERE number_of_terms > 1
    ORDER BY country, term, president_name;